version: 2

models:
    - name: stg_categories
      description: It contains all categories for products. One row per category.
      columns:
          - name: category_id
            description: The primary key of categories data.
            tests:
                - not_null
                - unique:
                    config: 
                      where: "category_name != 'Seafood'"
    - name: stg_orders
      description: It contains orders data. One row per order.
      columns:
          - name: order_id
            description: The primary key of orders data.
            tests:
                - not_null
                - unique
          - name: shipper_id
            tests:
              - relationships:
                  to: ref('stg_shippers')
                  field: shipper_id
              - accepted_values:
                  name: limited_shipper_reference
                  values: [1, 2, 3]
                  quote: false
    - name: stg_order_details
      description: It contains order details data. One row per order detail.
      tests:
          - unique:
              column_name: "order_id || '-' || product_id"
    - name: stg_products
      columns:
          - name: product_id
            description: The primary key of products data.
            tests:
                - not_null
                - unique
    - name: stg_customers
      columns:
          - name: customer_id
            description: The primary key of customers data.
            tests:
                - not_null
                - unique
    - name: stg_suppliers
      columns:
          - name: supplier_id
            description: The primary key of suppliers data.
            tests:
                - unique
    - name: stg_shippers
      columns:
          - name: shipper_id
            description: The primary key of shippers data.
            tests:
                - unique
    - name: stg_employees
      columns:
          - name: employee_id
            description: The primary key of employees data.
            tests:
                - unique